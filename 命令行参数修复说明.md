# auto_crawler.py 命令行参数修复说明

## 🔧 修复的问题

**问题**: 即使提供了命令行参数，程序仍然要求用户交互式输入目标URL或产品名称。

**原因**: 在 `main()` 函数中，有一个错误的 `else` 语句逻辑，导致当命令行参数中没有 `--max-retries` 时就进入交互模式。

## ✅ 修复内容

### 1. 修复命令行参数解析逻辑
- 移除了错误的 `else` 分支，确保有命令行参数时直接使用
- 添加了视频处理相关的命令行参数支持

### 2. 新增命令行参数
- `--download-videos`: 启用视频文件下载（默认禁用）
- `--max-video-size N`: 设置视频文件大小限制（MB，默认50）

### 3. 改进配置显示
- 在爬取开始前显示完整的配置信息
- 包括目标、代理、缓存、视频处理等设置

## 📖 使用方法

### 基本用法
```bash
# 直接指定产品名称
python auto_crawler.py iMac_M_Series

# 指定完整URL
python auto_crawler.py https://www.ifixit.com/Device/Television

# 指定类别名称
python auto_crawler.py Television
```

### 常用选项
```bash
# 启用详细输出
python auto_crawler.py iMac_M_Series --verbose

# 禁用代理池
python auto_crawler.py iMac_M_Series --no-proxy

# 强制刷新缓存
python auto_crawler.py iMac_M_Series --force-refresh

# 设置并发数
python auto_crawler.py iMac_M_Series --workers 8
```

### 视频处理选项
```bash
# 启用视频下载，默认50MB限制
python auto_crawler.py iMac_M_Series --download-videos

# 启用视频下载，限制10MB
python auto_crawler.py iMac_M_Series --download-videos --max-video-size 10

# 启用视频下载，限制100MB，详细输出
python auto_crawler.py iMac_M_Series --download-videos --max-video-size 100 --verbose
```

### 组合使用
```bash
# 完整配置示例
python auto_crawler.py iMac_M_Series \
  --verbose \
  --no-proxy \
  --download-videos \
  --max-video-size 20 \
  --workers 6 \
  --max-retries 3
```

## 📋 完整参数列表

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `[目标]` | URL或设备名（必需） | - |
| `--verbose` | 启用详细输出 | 否 |
| `--no-proxy` | 关闭代理池 | 启用代理 |
| `--no-cache` | 禁用缓存检查 | 启用缓存 |
| `--force-refresh` | 强制重新爬取 | 否 |
| `--workers N` | 并发线程数 | 4 |
| `--max-retries N` | 最大重试次数 | 5 |
| `--download-videos` | 启用视频下载 | 禁用 |
| `--max-video-size N` | 视频大小限制(MB) | 50 |

## 🎯 配置建议

### 快速爬取（推荐）
```bash
python auto_crawler.py iMac_M_Series --no-proxy
```
- 禁用代理，提升速度
- 不下载视频，节省空间
- 使用缓存，避免重复爬取

### 完整内容爬取
```bash
python auto_crawler.py iMac_M_Series --download-videos --max-video-size 50
```
- 下载视频文件
- 限制视频大小避免过大文件
- 获取完整媒体内容

### 大规模爬取
```bash
python auto_crawler.py Television --workers 8 --max-retries 3
```
- 增加并发数
- 适当减少重试次数
- 适合爬取大量内容

### 调试模式
```bash
python auto_crawler.py iMac_M_Series --verbose --no-proxy --force-refresh
```
- 详细输出，便于调试
- 禁用代理，避免网络问题
- 强制刷新，确保获取最新数据

## ✨ 示例输出

运行命令：
```bash
python auto_crawler.py iMac_M_Series --no-proxy --verbose
```

输出：
```
============================================================
开始整合爬取: iMac_M_Series
阶段1: 构建完整树形结构
阶段2: 为每个节点提取详细内容
============================================================
📋 爬取配置:
   目标: iMac_M_Series
   详细输出: 是
   使用代理: 否
   使用缓存: 是
   强制刷新: 否
   并发数: 4
   最大重试: 5
   下载视频: 否
```

## 🚀 验证修复

修复后的功能已验证：
- ✅ 命令行参数正确解析
- ✅ 不再要求交互式输入
- ✅ 配置信息正确显示
- ✅ 视频处理参数生效
- ✅ 所有原有功能正常工作

现在你可以直接使用命令行参数运行爬虫，无需任何交互式输入！
